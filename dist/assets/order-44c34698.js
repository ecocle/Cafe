import{r as t,j as e,c as O}from"./index-962b6f9e.js";import{p as Q}from"./paymentImage-1c1c593e.js";const V="_popup_18hbp_2",X="_open_18hbp_17",Z="_popupInner_18hbp_22",D="_closing_18hbp_34",L="_option_18hbp_113",ee="_price_18hbp_148",se="_name_18hbp_154",ne="_checkbox_18hbp_170",l={popup:V,open:X,popupInner:Z,"slide-in":"_slide-in_18hbp_1","fade-in":"_fade-in_18hbp_1",closing:D,"fade-out":"_fade-out_18hbp_1","slide-out":"_slide-out_18hbp_1","close-btn":"_close-btn_18hbp_75","input-group":"_input-group_18hbp_93","option-group":"_option-group_18hbp_113",option:L,"order-btn":"_order-btn_18hbp_126","no-line-break":"_no-line-break_18hbp_143",price:ee,name:se,checkbox:ne},oe="_popup_td4t6_1",ie="_open_td4t6_16",ce="_popupInner_td4t6_21",le="_close_td4t6_32",_={popup:oe,open:ie,popupInner:ce,close:le},te=({onClose:x,userData:d,price:a,selectedLanguage:h})=>{const[c,o]=t.useState(!0);return t.useEffect(()=>{console.log(d),d&&d.balance===0&&d.username===""||d.balance>=a&&o(!1)},[]),e.jsx("div",{className:_.popup,children:e.jsxs("div",{className:_.popupInner,children:[c&&e.jsxs("div",{children:[e.jsx("img",{src:Q,alt:"Payment Image",style:{maxHeight:"12em"}}),e.jsxs("p",{children:[h==="chinese"?"你需要付":"You need to pay"," ",e.jsxs("span",{style:{fontWeight:"bold"},children:["¥",a]})]})]}),e.jsx("h2",{children:h==="chinese"?"订单成功！":"Order Successful!"}),e.jsx("p",{children:h==="chinese"?"您的订单已成功下达。":"Your order has been placed successfully."}),!c&&e.jsx("div",{children:e.jsxs("p",{children:[h==="chinese"?"你还剩":"You have"," ",e.jsxs("span",{style:{fontWeight:"bold"},children:["¥",d.balance-a]})," ",h==="chinese"?"在你帐号里":"Left in your account"]})}),e.jsx("button",{onClick:x,className:_.close,children:h==="chinese"?"返回":"Go back"})]})})},he=({isOpen:x,onClose:d,name:a,originalPrice:h,userData:c,selectedLanguage:o})=>{const[f,k]=t.useState(!1),[I,C]=t.useState(!1),[v,w]=t.useState("cold"),[m,B]=t.useState("medium"),[p,z]=t.useState([]),[y,S]=t.useState(""),[N,E]=t.useState(""),[u,j]=t.useState(h),[P,$]=t.useState(""),[T,M]=t.useState(!1),R=["Crispy cereal in milk(classic)","Crispy cereal in milk(honey)","Crispy cereal in milk(chocolate)","Classic flavored Porridge","Chocolate flavored Porridge"],H=["Crispy cereal in milk(classic)","Crispy cereal in milk(honey)","Crispy cereal in milk(chocolate)","Classic flavored Porridge","Chocolate flavored Porridge"],U=["Crispy cereal in milk(classic)","Crispy cereal in milk(honey)","Crispy cereal in milk(chocolate)","Cocoa","Matcha milk","Matcha boba","Tai Red Tea","Coconut Water","Milk tea","Jasmine Milktea","Boba","Refreshing babyblue drink","Pure milk"],W=["Classic flavored Porridge","Chocolate flavored Porridge"],Y=["Crispy cereal in milk(classic)","Crispy cereal in milk(honey)","Crispy cereal in milk(chocolate)","Classic flavored Porridge","Chocolate flavored Porridge"];t.useEffect(()=>{c&&(S(c.username),E(c.username))},[c]);const F=n=>{const r=n.target.value;B(r);let s=h;r==="large"&&(s+=3),p.forEach(i=>{i==="oatmilkSubstitution"||i==="boba"?s+=1:i==="extraExpressoShot"?s+=2:i==="redBean"&&(s+=1)}),j(s)},J=n=>{const r=n.target.checked;M(r);let s=h;r&&(s-=1),p.forEach(i=>{i==="oatmilkSubstitution"||i==="boba"?s+=1:i==="extraExpressoShot"?s+=2:i==="redBean"&&(s+=1)}),j(s)},b=n=>{const r=p.includes(n)?p.filter(i=>i!==n):[...p,n];z(r);let s=h;m==="large"&&(s+=3),r.forEach(i=>{i==="oatmilkSubstitution"||i==="boba"?s+=1:i==="extraExpressoShot"?s+=2:i==="redBean"&&(s+=1)}),j(s)},A=async()=>{let n;c&&c.balance===0&&c.username===""?n=0:c.balance>=u?n=c.balance-u:n=c.balance;const r={name:a,temperature:v,selectedSize:m,selectedToppings:p,firstName:y,lastName:N,price:u,comments:P,useCup:T,balance:n};try{const s=q("access_token");console.log(r);const i=await fetch("/api/orders",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(r)});i.ok||console.error("Network response was not ok");const K=await i.json();console.log("Order placed successfully:",K),C(!0)}catch(s){console.error("Error placing order:",s)}},G=n=>{k(!0),setTimeout(()=>{d(n),k(!1)},300)},g=n=>{C(!1),d(n),window.location.href="/"},q=n=>{var i;const s=`; ${document.cookie}`.split(`; ${n}=`);if(s.length===2)return(i=s.pop())==null?void 0:i.split(";").shift()};return e.jsx("div",{className:O(l.popup,{[l.open]:x,[l.closing]:f}),children:e.jsxs("div",{className:O(l.popupInner,{[l.closing]:f}),children:[I&&e.jsx(te,{isOrdered:!0,onClose:g,userData:c,price:u,selectedLanguage:o}),e.jsxs("div",{children:[e.jsx("button",{className:l["close-btn"],onClick:G,children:o==="chinese"?"关闭":"Close"}),e.jsx("p",{className:l.name,children:a})]}),e.jsx("h2",{children:o==="chinese"?"选择选项":"Select Options"}),e.jsx("div",{className:"option",children:e.jsxs("label",{children:[o==="chinese"?"温度:":"Temperature:",e.jsxs("select",{value:v,onChange:n=>w(n.target.value),children:[!U.includes(a)&&e.jsx("option",{value:"hot",children:o==="chinese"?"热":"Hot"}),!W.includes(a)&&e.jsx("option",{value:"cold",children:o==="chinese"?"冷":"Cold"}),!Y.includes(a)&&e.jsx("option",{value:"normal",children:o==="chinese"?"正常":"Normal"})]})]})}),!R.includes(a)&&e.jsx("div",{className:"option",children:e.jsxs("label",{children:[o==="chinese"?"大小:":"Size:",e.jsxs("select",{value:m,onChange:F,children:[e.jsx("option",{value:"medium",children:o==="chinese"?"中":"Medium"}),e.jsx("option",{value:"large",children:o==="chinese"?"大":"Large"})]})]})}),!H.includes(a)&&e.jsx("div",{className:"option",children:e.jsxs("label",{children:[o==="chinese"?"配料":"Toppings:",e.jsxs("div",{children:[e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",value:"oatmilkSubstitution",className:l.checkbox,checked:p.includes("oatmilkSubstitution"),onChange:()=>b("oatmilkSubstitution")}),e.jsx("span",{className:"no-line-break",children:o==="chinese"?"燕麦奶更换":"Oat Milk Substitution"})]}),"fi ",e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",value:"boba",className:l.checkbox,checked:p.includes("boba"),onChange:()=>b("boba")}),e.jsx("span",{className:"no-line-break",children:o==="chinese"?"珍珠":"Boba"})]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",value:"extraExpressoShot",className:l.checkbox,checked:p.includes("extraExpressoShot"),onChange:()=>b("extraExpressoShot"),disabled:!0}),e.jsx("span",{className:"no-line-break",children:e.jsx("s",{children:o==="chinese"?"外加一份浓缩":"Extra Espresso Shot"})})]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",value:"redBean",className:l.checkbox,checked:p.includes("redBean"),onChange:()=>b("redBean")}),e.jsx("span",{className:"no-line-break",children:o==="chinese"?"红豆":"Red Bean"})]})]})]})}),e.jsx("div",{className:"option",children:e.jsxs("label",{children:[o==="chinese"?"名":"First Name:",e.jsx("input",{type:"text",value:y,onChange:n=>S(n.target.value)})]})}),e.jsx("div",{className:"option",children:e.jsxs("label",{children:[o==="chinese"?"姓":"Last Name:",e.jsx("input",{type:"text",value:N,onChange:n=>E(n.target.value)})]})}),e.jsx("div",{className:"option",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:T,onChange:J}),e.jsx("span",{className:"no-line-break",children:o==="chinese"?"用自己的杯子":"Use own cup"})]})}),e.jsx("div",{className:"option",children:e.jsx("label",{children:e.jsx("textarea",{value:P,onChange:n=>$(n.target.value),placeholder:o==="chinese"?"备注":"Comments",style:{resize:"none"}})})}),e.jsx("button",{onClick:A,className:l["order-btn"],children:o==="chinese"?"点单":"Place Order"}),e.jsx("div",{children:e.jsxs("p",{className:l.price,children:[o==="chinese"?"总价":"Total price:",u]})})]})})};export{he as O};
