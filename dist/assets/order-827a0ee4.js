import{r as t,j as e,c as T}from"./index-f1d7d55c.js";import{p as Q}from"./paymentImage-1c1c593e.js";const V="_popup_1qp40_2",X="_open_1qp40_17",Z="_popupInner_1qp40_22",D="_closing_1qp40_34",L="_option_1qp40_113",ee="_price_1qp40_153",se="_name_1qp40_159",oe="_checkbox_1qp40_175",l={popup:V,open:X,popupInner:Z,"slide-in":"_slide-in_1qp40_1","fade-in":"_fade-in_1qp40_1",closing:D,"fade-out":"_fade-out_1qp40_1","slide-out":"_slide-out_1qp40_1","close-btn":"_close-btn_1qp40_75","input-group":"_input-group_1qp40_93","option-group":"_option-group_1qp40_113",option:L,"order-btn":"_order-btn_1qp40_126","no-line-break":"_no-line-break_1qp40_148",price:ee,name:se,checkbox:oe},ne="_popup_td4t6_1",ie="_open_td4t6_16",ce="_popupInner_td4t6_21",le="_close_td4t6_32",_={popup:ne,open:ie,popupInner:ce,close:le},te=({onClose:m,userData:d,price:a,selectedLanguage:p})=>{const[c,n]=t.useState(!0);return t.useEffect(()=>{console.log(d),d&&d.balance===0&&d.username===""||d.balance>=a&&n(!1)},[]),e.jsx("div",{className:_.popup,children:e.jsxs("div",{className:_.popupInner,children:[c&&e.jsxs("div",{children:[e.jsx("img",{src:Q,alt:"Payment Image",style:{maxHeight:"12em"}}),e.jsxs("p",{children:[p==="chinese"?"你需要付":"You need to pay"," ",e.jsxs("span",{style:{fontWeight:"bold"},children:["¥",a]})]})]}),e.jsx("h2",{children:p==="chinese"?"订单成功！":"Order Successful!"}),e.jsx("p",{children:p==="chinese"?"您的订单已成功下达。":"Your order has been placed successfully."}),!c&&e.jsx("div",{children:e.jsxs("p",{children:[p==="chinese"?"你还剩":"You have"," ",e.jsxs("span",{style:{fontWeight:"bold"},children:["¥",d.balance-a]})," ",p==="chinese"?"在你帐号里":"Left in your account"]})}),e.jsx("button",{onClick:m,className:_.close,children:p==="chinese"?"返回":"Go back"})]})})},pe=({isOpen:m,onClose:d,name:a,originalPrice:p,userData:c,selectedLanguage:n})=>{const[f,k]=t.useState(!1),[O,C]=t.useState(!1),[v,I]=t.useState("cold"),[b,w]=t.useState("medium"),[h,B]=t.useState([]),[y,S]=t.useState(""),[N,q]=t.useState(""),[u,j]=t.useState(p),[E,z]=t.useState(""),[P,M]=t.useState(!1),$=["Crispy cereal in milk(classic)","Crispy cereal in milk(honey)","Crispy cereal in milk(chocolate)","Classic flavored Porridge","Chocolate flavored Porridge"],R=["Crispy cereal in milk(classic)","Crispy cereal in milk(honey)","Crispy cereal in milk(chocolate)","Classic flavored Porridge","Chocolate flavored Porridge"],H=["Crispy cereal in milk(classic)","Crispy cereal in milk(honey)","Crispy cereal in milk(chocolate)","Cocoa","Matcha milk","Matcha boba","Tai Red Tea","Coconut Water","Milk tea","Jasmine Milktea","Boba","Refreshing babyblue drink","Pure milk"],U=["Classic flavored Porridge","Chocolate flavored Porridge"],W=["Crispy cereal in milk(classic)","Crispy cereal in milk(honey)","Crispy cereal in milk(chocolate)","Classic flavored Porridge","Chocolate flavored Porridge"];t.useEffect(()=>{c&&(S(c.username),q(c.username))},[c]);const Y=o=>{const r=o.target.value;w(r);let s=p;r==="large"&&(s+=3),h.forEach(i=>{i==="oatmilkSubstitution"||i==="boba"?s+=1:i==="extraExpressoShot"?s+=2:i==="redBean"&&(s+=1)}),j(s)},F=o=>{const r=o.target.checked;M(r);let s=p;r&&(s-=1),h.forEach(i=>{i==="oatmilkSubstitution"||i==="boba"?s+=1:i==="extraExpressoShot"?s+=2:i==="redBean"&&(s+=1)}),j(s)},x=o=>{const r=h.includes(o)?h.filter(i=>i!==o):[...h,o];B(r);let s=p;b==="large"&&(s+=3),r.forEach(i=>{i==="oatmilkSubstitution"||i==="boba"?s+=1:i==="extraExpressoShot"?s+=2:i==="redBean"&&(s+=1)}),j(s)},J=async()=>{let o;c&&c.balance===0&&c.username===""?o=0:c.balance>=u?o=c.balance-u:o=c.balance;const r={name:a,temperature:v,selectedSize:b,selectedToppings:h,firstName:y,lastName:N,price:u,comments:E,useCup:P,balance:o};try{const s=g("access_token");console.log(r);const i=await fetch("/api/orders",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(r)});i.ok||console.error("Network response was not ok");const K=await i.json();console.log("Order placed successfully:",K),C(!0)}catch(s){console.error("Error placing order:",s)}},A=o=>{k(!0),setTimeout(()=>{d(o),k(!1)},300)},G=o=>{C(!1),d(o),window.location.href="/"},g=o=>{var i;const s=`; ${document.cookie}`.split(`; ${o}=`);if(s.length===2)return(i=s.pop())==null?void 0:i.split(";").shift()};return e.jsx("div",{className:T(l.popup,{[l.open]:m,[l.closing]:f}),children:e.jsxs("div",{className:T(l.popupInner,{[l.closing]:f}),children:[O&&e.jsx(te,{isOrdered:!0,onClose:G,userData:c,price:u,selectedLanguage:n}),e.jsxs("div",{children:[e.jsx("button",{className:l["close-btn"],onClick:A,children:n==="chinese"?"关闭":"Close"}),e.jsx("p",{className:l.name,children:a})]}),e.jsx("h2",{children:n==="chinese"?"选择选项":"Select Options"}),e.jsx("div",{className:"option",children:e.jsxs("label",{children:[n==="chinese"?"温度:":"Temperature:",e.jsxs("select",{value:v,onChange:o=>I(o.target.value),children:[!H.includes(a)&&e.jsx("option",{value:"hot",children:n==="chinese"?"热":"Hot"}),!U.includes(a)&&e.jsx("option",{value:"cold",children:n==="chinese"?"冷":"Cold"}),!W.includes(a)&&e.jsx("option",{value:"normal",children:n==="chinese"?"正常":"Normal"})]})]})}),!$.includes(a)&&e.jsx("div",{className:"option",children:e.jsxs("label",{children:[n==="chinese"?"大小:":"Size:",e.jsx("select",{value:b,onChange:Y,children:e.jsx("option",{value:"medium",children:n==="chinese"?"中":"Medium"})})]})}),!R.includes(a)&&e.jsx("div",{className:"option",children:e.jsxs("label",{children:[n==="chinese"?"配料":"Toppings:",e.jsxs("div",{children:[e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",value:"oatmilkSubstitution",className:l.checkbox,checked:h.includes("oatmilkSubstitution"),onChange:()=>x("oatmilkSubstitution")}),e.jsx("span",{className:"no-line-break",children:n==="chinese"?"燕麦奶更换":"Oat Milk Substitution"})]}),"fi ",e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",value:"boba",className:l.checkbox,checked:h.includes("boba"),onChange:()=>x("boba")}),e.jsx("span",{className:"no-line-break",children:n==="chinese"?"珍珠":"Boba"})]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",value:"extraExpressoShot",className:l.checkbox,checked:h.includes("extraExpressoShot"),onChange:()=>x("extraExpressoShot"),disabled:!0}),e.jsx("span",{className:"no-line-break",children:e.jsx("s",{children:n==="chinese"?"外加一份浓缩":"Extra Espresso Shot"})})]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",value:"redBean",className:l.checkbox,checked:h.includes("redBean"),onChange:()=>x("redBean")}),e.jsx("span",{className:"no-line-break",children:n==="chinese"?"红豆":"Red Bean"})]})]})]})}),e.jsx("div",{className:"option",children:e.jsxs("label",{children:[n==="chinese"?"名":"First Name:",e.jsx("input",{type:"text",value:y,onChange:o=>S(o.target.value)})]})}),e.jsx("div",{className:"option",children:e.jsxs("label",{children:[n==="chinese"?"姓":"Last Name:",e.jsx("input",{type:"text",value:N,onChange:o=>q(o.target.value)})]})}),e.jsx("div",{className:"option",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:P,onChange:F,className:l.checkbox}),e.jsx("span",{className:"no-line-break",children:n==="chinese"?"用自己的杯子":"Use own cup"})]})}),e.jsx("div",{className:"option",children:e.jsx("label",{children:e.jsx("textarea",{value:E,onChange:o=>z(o.target.value),placeholder:n==="chinese"?"备注":"Comments",style:{resize:"none"}})})}),e.jsx("button",{onClick:J,className:l["order-btn"],children:n==="chinese"?"点单":"Place Order"}),e.jsx("div",{children:e.jsxs("p",{className:l.price,children:[n==="chinese"?"总价":"Total price:",u]})})]})})};export{pe as O};
